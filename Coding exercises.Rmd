---
title: "Coding Exercises"
author: "Taia Storrs"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Part 1
```{r}
data("knz_bison")
```

Create a new column in the bison dataset that calculates the individualâ€™s age at the time of observation.

```{r}
knz_bison <- knz_bison %>%
  mutate(age = rec_year - animal_yob)
```

Write a function that will first filter the bison dataset based on any user-specified weight threshold (returning the filtered dataset).

```{r}
bison_weight <- function(knz_bison, weight_threshold) {
  filtered_data <- knz_bison %>%
    filter(animal_weight > weight_threshold)
  
   return(filtered_data)
}
```

Example
```{r}
bison_over_600 <- bison_weight(knz_bison, 600)
```

Create a boxplot showing weight distribution between male and female bison, and then conduct a t-test to see if weight is significantly difference between males and females.

```{r}
ggplot(knz_bison, aes(x = animal_sex, y = animal_weight, fill = animal_sex)) +
  geom_boxplot() +
  labs(
    x = "Sex",
    y = "Weight (kg)"
  ) +
  scale_fill_manual(values = c("M" = "goldenrod2", "F" = "slateblue")) +
  theme_minimal()
```

Part 2
```{r}
data <- read.csv("Intro-Git-GitHub/data/kenya_county_climates.csv")
```

```{r}
precip_data <- data %>%
  select(County, contains("Precipitation")) %>%
  filter(Precipitation_585_90 > mean(Precipitation_585_90, na.rm = TRUE)) %>%
  pivot_longer(
    cols = contains("Precipitation"),
    names_to = "Precip_Variable",
    values_to = "Precip_Value"
  )
```

```{r}
precip_data%>%
  distinct(County) %>% 
  count()
```

22 counties have predicted precip values greater than the total county average

```{r}
precip_data %>%
  ggplot(aes(x = County, y = Precip_Value, fill = Precip_Variable)) +
  geom_col(position = "dodge") +
  facet_wrap(~Precip_Variable, scales = "free_y") +
  labs(
    title = "Predicted Precipitation by County and Time Frame",
    x = "County",
    y = "Precipitation",
    fill = "Time Frame"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

```

```{r}
county_list <- unique(precip_data$County)

plots <- map(county_list, ~{
  precip_data %>%
    filter(County == .x) %>%
    ggplot(aes(x = Precip_Variable, y = Precip_Value, fill = Precip_Variable)) +
    geom_col() +
    labs(
      title = paste("Predicted Precipitation for", .x),
      x = "Precipitation Variable",
      y = "Precipitation",
      fill = "Scenario"
    ) +
    theme_minimal() +
    theme(
      legend.position = "none",
      axis.text.x = element_text(angle = 45, hjust = 1)
    )
})

plots[[1]]

```

